<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Tests for significant differences among all pairs of slopes in a dummy variable regression (DVR). — compSlopes • FSA</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Tests for significant differences among all pairs of slopes in a dummy variable regression (DVR). — compSlopes" />
<meta property="og:description" content="Tests for significant differences among all pairs of slopes in a dummy variable regression where the dummy variables all stem from one factor." />
<meta property="og:image" content="http://derekogle.com/FSA/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FSA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.8.31.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-2x"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/droglenc/FSA">
    <span class="fas fa-github fa-2x"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Tests for significant differences among all pairs of slopes in a dummy variable regression (DVR).</h1>
    <small class="dont-index">Source: <a href='https://github.com/droglenc/FSA/blob/master/R/comparisonsDVR.R'><code>R/comparisonsDVR.R</code></a></small>
    <div class="hidden name"><code>compSlopes.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Tests for significant differences among all pairs of slopes in a dummy variable regression where the dummy variables all stem from one factor.</p>
    </div>

    <pre class="usage"><span class='fu'>compSlopes</span><span class='op'>(</span>
  <span class='va'>mdl</span>,
  method <span class='op'>=</span> <span class='fu'>stats</span><span class='fu'>::</span><span class='va'><a href='https://rdrr.io/r/stats/p.adjust.html'>p.adjust.methods</a></span>,
  conf.level <span class='op'>=</span> <span class='fl'>0.95</span>,
  order.slopes <span class='op'>=</span> <span class='cn'>TRUE</span>,
  digits <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span><span class='op'>(</span><span class='st'>"digits"</span><span class='op'>)</span>
<span class='op'>)</span>

<span class='co'># S3 method for compSlopes</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>mdl</th>
      <td><p>A <code>lm</code> object.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>A string indicating the method of p-value adjustment to use. See details and <code>p.adjust.methods</code> (documented in <code><a href='https://rdrr.io/r/stats/p.adjust.html'>p.adjust</a></code>.</p></td>
    </tr>
    <tr>
      <th>conf.level</th>
      <td><p>A single number that represents the level of confidence to use for constructing confidence intervals.</p></td>
    </tr>
    <tr>
      <th>order.slopes</th>
      <td><p>A logical indicating whether the slopes should be ordered from smallest to largest upon output.</p></td>
    </tr>
    <tr>
      <th>digits</th>
      <td><p>A numeric that controls the number of digits to print.</p></td>
    </tr>
    <tr>
      <th>x</th>
      <td><p>A <code>compSlopes</code> object (i.e., returned from <code>compSlopes</code>).</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Other arguments sent to <code>print</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list with three components. The first component contains the p-value adjustment method in <code>method</code>. The second component, called <code>comparisons</code>, is a data.frame that contains the following:</p><table class='table'>
<tr><td><code>comparison</code></td><td>Description of how the difference in levels was computed.</td></tr>
<tr><td><code>diff</code></td><td>The estimated difference in slope values.</td></tr>
<tr><td><code>lwr</code></td><td>Lower confidence bound for difference in slope values.</td></tr>
<tr><td><code>upr</code></td><td>Upper confidence bound for difference in slope values.</td></tr>
<tr><td><code>p.unadj</code></td><td>Unadjusted p-value for testing the difference in slopes is zero.</td></tr>
<tr><td><code>p.adj</code></td><td>Adjusted p-value for testing the difference in slopes is zero.</td></tr>
</table>


<p>The third component, called <code>slopes</code>, is a data.frame that contains the following:</p><table class='table'>
<tr><td><code>level</code></td><td>A level name.</td></tr>
<tr><td><code>slope</code></td><td>The estimated slope value for the given level.</td></tr>
<tr><td><code>XX LCI</code></td><td>Lower confidence bound for difference in slope values.</td></tr>
<tr><td><code>XX UCI</code></td><td>Upper confidence bound for difference in slope values.</td></tr>
<tr><td><code>p.unadj</code></td><td>Unadjusted p-value for testing the slope is zero.</td></tr>
<tr><td><code>p.adj</code></td><td>Adjusted p-value for testing the slope is zero.</td></tr>
</table>


<p>The <code>print</code> function prints the results nicely.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>In a dummy variable regression the coefficient for the interaction between the covariate (x) and a dummy variable tests for a difference in slopes between the level of the dummy variable and the reference level. Thus, all dummy variables from a particular linear model fit only compare slopes with the reference level. Other slope comparisons may be found by changing the reference level, which requires refitting the model. This function automates this sequential process and produces a data.frame that shows the estimated difference, an unadjusted confidence interval for the difference, and the unadjusted and adjusted (for multiple comparisons) p-values for testing that the difference in slopes is equal to zero for each pair of levels. The adjusted p-values may be computed with any of the methods coded in <code><a href='https://rdrr.io/r/stats/p.adjust.html'>p.adjust</a></code> (see <code>p.adjust.methods</code> there).</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>This function only works for linear models with one factor variable.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='compIntercepts.html'>compIntercepts</a></code> in <span class="pkg">FSA</span>.</p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Derek H. Ogle, <a href='mailto:derek@derekogle.com'>derek@derekogle.com</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>Mirex</span><span class='op'>$</span><span class='va'>year</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/factor.html'>factor</a></span><span class='op'>(</span><span class='va'>Mirex</span><span class='op'>$</span><span class='va'>year</span><span class='op'>)</span>
<span class='co'># fit a dummy variable regression, see that slopes differ</span>
<span class='va'>lm1</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/lm.html'>lm</a></span><span class='op'>(</span><span class='va'>mirex</span><span class='op'>~</span><span class='va'>weight</span><span class='op'>*</span><span class='va'>year</span>,data<span class='op'>=</span><span class='va'>Mirex</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span><span class='op'>(</span><span class='va'>lm1</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Analysis of Variance Table
#&gt; 
#&gt; Response: mirex
#&gt;              Df  Sum Sq  Mean Sq F value    Pr(&gt;F)    
#&gt; weight        1 0.22298 0.222980 60.2061   4.7e-12 ***
#&gt; year          5 0.50667 0.101333 27.3607 &lt; 2.2e-16 ***
#&gt; weight:year   5 0.09351 0.018703  5.0499 0.0003326 ***
#&gt; Residuals   110 0.40740 0.003704                      
#&gt; ---
#&gt; Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</div><div class='input'><span class='co'># compare all pairs of slopes using default Holm control</span>
<span class='fu'>compSlopes</span><span class='op'>(</span><span class='va'>lm1</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Multiple Slope Comparisons (using the 'holm' adjustment)</span></div><div class='output co'>#&gt;    comparison     diff  95% LCI  95% UCI p.unadj   p.adj
#&gt; 1   1982-1977 -0.00202 -0.01678  0.01273 0.78627 1.00000
#&gt; 2   1986-1977 -0.00331 -0.01670  0.01008 0.62556 1.00000
#&gt; 3   1992-1977 -0.00233 -0.01676  0.01211 0.75010 1.00000
#&gt; 4   1996-1977 -0.01661 -0.02903 -0.00418 0.00929 0.09394
#&gt; 5   1999-1977 -0.02500 -0.03964 -0.01036 0.00099 0.01386
#&gt; 6   1986-1982 -0.00128 -0.01393  0.01137 0.84111 1.00000
#&gt; 7   1992-1982 -0.00030 -0.01405  0.01345 0.96535 1.00000
#&gt; 8   1996-1982 -0.01458 -0.02621 -0.00295 0.01445 0.11790
#&gt; 9   1999-1982 -0.02297 -0.03694 -0.00901 0.00149 0.01788
#&gt; 10  1992-1986  0.00098 -0.01130  0.01326 0.87451 1.00000
#&gt; 11  1996-1986 -0.01330 -0.02314 -0.00346 0.00854 0.09394
#&gt; 12  1999-1986 -0.02169 -0.03421 -0.00917 0.00084 0.01260
#&gt; 13  1996-1992 -0.01428 -0.02550 -0.00306 0.01310 0.11790
#&gt; 14  1999-1992 -0.02267 -0.03630 -0.00904 0.00132 0.01716
#&gt; 15  1999-1996 -0.00839 -0.01988  0.00309 0.15049 1.00000</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Slope Information (using the 'holm' adjustment)</span></div><div class='output co'>#&gt;   level  slopes  95% LCI 95% UCI p.unadj  p.adj
#&gt; 6  1999 0.00386 -0.00593 0.01366  0.4362 0.4362
#&gt; 5  1996 0.01225  0.00625 0.01826  0.0001 0.0002
#&gt; 3  1986 0.02555  0.01775 0.03335  0.0000 0.0000
#&gt; 4  1992 0.02653  0.01705 0.03602  0.0000 0.0000
#&gt; 2  1982 0.02684  0.01688 0.03680  0.0000 0.0000
#&gt; 1  1977 0.02886  0.01798 0.03974  0.0000 0.0000</div><div class='input'><span class='co'># compare all pairs of slopes using the false discovery rate control</span>
<span class='fu'>compSlopes</span><span class='op'>(</span><span class='va'>lm1</span>,method<span class='op'>=</span><span class='st'>"fdr"</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Multiple Slope Comparisons (using the 'fdr' adjustment)</span></div><div class='output co'>#&gt;    comparison     diff  95% LCI  95% UCI p.unadj   p.adj
#&gt; 1   1982-1977 -0.00202 -0.01678  0.01273 0.78627 0.93698
#&gt; 2   1986-1977 -0.00331 -0.01670  0.01008 0.62556 0.93698
#&gt; 3   1992-1977 -0.00233 -0.01676  0.01211 0.75010 0.93698
#&gt; 4   1996-1977 -0.01661 -0.02903 -0.00418 0.00929 0.02322
#&gt; 5   1999-1977 -0.02500 -0.03964 -0.01036 0.00099 0.00559
#&gt; 6   1986-1982 -0.00128 -0.01393  0.01137 0.84111 0.93698
#&gt; 7   1992-1982 -0.00030 -0.01405  0.01345 0.96535 0.96535
#&gt; 8   1996-1982 -0.01458 -0.02621 -0.00295 0.01445 0.02709
#&gt; 9   1999-1982 -0.02297 -0.03694 -0.00901 0.00149 0.00559
#&gt; 10  1992-1986  0.00098 -0.01130  0.01326 0.87451 0.93698
#&gt; 11  1996-1986 -0.01330 -0.02314 -0.00346 0.00854 0.02322
#&gt; 12  1999-1986 -0.02169 -0.03421 -0.00917 0.00084 0.00559
#&gt; 13  1996-1992 -0.01428 -0.02550 -0.00306 0.01310 0.02709
#&gt; 14  1999-1992 -0.02267 -0.03630 -0.00904 0.00132 0.00559
#&gt; 15  1999-1996 -0.00839 -0.01988  0.00309 0.15049 0.25082</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Slope Information (using the 'fdr' adjustment)</span></div><div class='output co'>#&gt;   level  slopes  95% LCI 95% UCI p.unadj   p.adj
#&gt; 6  1999 0.00386 -0.00593 0.01366  0.4362 0.43620
#&gt; 5  1996 0.01225  0.00625 0.01826  0.0001 0.00012
#&gt; 3  1986 0.02555  0.01775 0.03335  0.0000 0.00000
#&gt; 4  1992 0.02653  0.01705 0.03602  0.0000 0.00000
#&gt; 2  1982 0.02684  0.01688 0.03680  0.0000 0.00000
#&gt; 1  1977 0.02886  0.01798 0.03974  0.0000 0.00000</div><div class='input'><span class='co'># visualize the results</span>
<span class='fu'><a href='fitPlot.html'>fitPlot</a></span><span class='op'>(</span><span class='va'>lm1</span><span class='op'>)</span>
</div><div class='img'><img src='compSlopes-1.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Derek Ogle, Powell Wheeler, Alexis Dinno.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


